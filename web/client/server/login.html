<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
        <link href="bootstrap.min.css" rel="stylesheet">
        <script src="jquery-3.4.1.js"></script>
        <link href="floating-labels.css" rel="stylesheet">
</head>
    <body onkeydown="enter()">
        <form class="form-signin">
            <div class="text-center mb-4">
                <h1 class="h3 mb-3 font-weight-normal">登入</h1>
            </div>

            <div>
                <label for="inputaccount">Account</label>
                    <input type="text" id="inputaccount" class="form-control_login" required autofocus>
            </div>

            <div>
                <label for="inputPassword">Password</label>
                    <input  type="password" id="inputPassword" class="form-control_login"  required>
            </div>

            <div class="checkbox mb-3">
                 <input type="checkbox" id="remeber" value="remember-me"> Remember mee
            </div>

            <div>
                <button class="btn btn-lg btn-primary btn-block" type="button" id="as">Login</button>
            </div>
        </form>
    </body>


<script>
    var remeber_account;
    var remeber_account_text;
    remeber_account = document.cookie;
    remeber_account_text = remeber_account.substr(5);
    $("#inputaccount").val(remeber_account_text);
    $("#as").click(function () {
        if ($("#inputaccount").val() == "" || $("#inputPassword").val() == ""){
            alert("帳號密碼不可為空！！")
            return
        }
        $.ajax({
            type: 'post',
            url: 'https://djangotest1156.herokuapp.com/api/RSS/login/',
            data: {
                "account": $("#inputaccount").val(),
                "password": $("#inputPassword").val()
            },
            success: function (result) {
                if (result){
                    if($("#remeber").prop("checked")){
                        document.cookie = "user="+$("#inputaccount").val();
                        window.location.href="manage.html?"+result+$("#inputaccount").val();
                    }else{
                        document.cookie = "user="+""
                        window.location.href="manage.html?"+result+$("#inputaccount").val();
                    }

                }
                else {
                        alert("登入失敗")
                }
            },
            error: function () {
                alert("連接錯誤")
            }
        });
    });
function enter() {
    if(event.keyCode ==13) {
            if ($("#inputaccount").val() == "" || $("#inputPassword").val() == "") {
                alert("帳號密碼不可為空！！")
                return
            }
        $.ajax({
            type: 'post',
            url: 'https://djangotest1156.herokuapp.com/api/RSS/login/',
            data: {
                "account": $("#inputaccount").val(),
                "password": $("#inputPassword").val()
            },
            success: function (result) {
                if (result) {
                    if($("#remeber").prop("checked")){
                        document.cookie = "user="+$("#inputaccount").val();
                        window.location.href="manage.html?"+result+$("#inputaccount").val();
                    }else{
                        document.cookie = "user="+""
                        window.location.href="manage.html?"+result+$("#inputaccount").val();
                    }
                }
                else {
                    alert("登入失敗")
                }
            },
            error: function () {
                alert("連接錯誤")
            }
        });
    }
}
</script>
</html>

